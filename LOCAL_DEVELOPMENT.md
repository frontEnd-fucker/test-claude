# æœ¬åœ°Supabaseå¼€å‘ç¯å¢ƒæŒ‡å—

## æ¦‚è¿°

æœ¬é¡¹ç›®æ”¯æŒæœ¬åœ°Supabaseå¼€å‘ç¯å¢ƒï¼Œå…è®¸å¼€å‘è€…åœ¨ç¦»çº¿çŠ¶æ€ä¸‹è¿›è¡Œå¼€å‘ï¼Œé¿å…å¯¹ç”Ÿäº§æ•°æ®çš„æ±¡æŸ“ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

## ä¼˜åŠ¿

âœ… **ç¦»çº¿å¼€å‘** - æ— éœ€ç½‘ç»œè¿æ¥å³å¯è¿›è¡Œå¼€å‘
âœ… **æ•°æ®éš”ç¦»** - å¼€å‘æ•°æ®å®Œå…¨ç‹¬ç«‹ï¼Œä¸å½±å“ç”Ÿäº§ç¯å¢ƒ
âœ… **å¿«é€Ÿè¿­ä»£** - æ— ç½‘ç»œå»¶è¿Ÿï¼Œæ•°æ®åº“æ“ä½œæ›´å¿«
âœ… **æˆæœ¬èŠ‚çº¦** - ä¸æ¶ˆè€—äº‘ç«¯èµ„æº
âœ… **è°ƒè¯•æ–¹ä¾¿** - ç›´æ¥è®¿é—®æœ¬åœ°æ•°æ®åº“å’Œæ—¥å¿—

## ç¯å¢ƒè¦æ±‚

### å¿…éœ€å·¥å…·
1. **Docker Desktop** - [ä¸‹è½½åœ°å€](https://www.docker.com/products/docker-desktop)
2. **Supabase CLI** - å®‰è£…æ–¹æ³•ï¼š
   ```bash
   # æ–¹æ³•1: npmå…¨å±€å®‰è£…
   npm install -g supabase

   # æ–¹æ³•2: brewå®‰è£… (macOS)
   brew install supabase/tap/supabase
   ```

### éªŒè¯å®‰è£…
```bash
# æ£€æŸ¥Dockeræ˜¯å¦è¿è¡Œ
docker --version

# æ£€æŸ¥Supabase CLI
supabase --version
```

## å¿«é€Ÿå¼€å§‹

### 1. ä¸€é”®å¯åŠ¨æœ¬åœ°å¼€å‘ç¯å¢ƒ
```bash
npm run dev:local
```
è¿™ä¸ªå‘½ä»¤ä¼šï¼š
- å¯åŠ¨æœ¬åœ°SupabaseæœåŠ¡
- åº”ç”¨æ‰€æœ‰æ•°æ®åº“è¿ç§»
- å¯åŠ¨Next.jså¼€å‘æœåŠ¡å™¨

### 2. åˆ†æ­¥å¯åŠ¨
```bash
# å¯åŠ¨SupabaseæœåŠ¡
npm run supabase:start

# åœ¨æ–°ç»ˆç«¯ä¸­å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 3. è®¿é—®æœåŠ¡
- **åº”ç”¨**: http://localhost:3000
- **Supabase Studio**: http://localhost:54323
- **APIç«¯ç‚¹**: http://localhost:54321

## ç¯å¢ƒé…ç½®

### ç¯å¢ƒå˜é‡
é¡¹ç›®è‡ªåŠ¨æ ¹æ® `NODE_ENV` é€‰æ‹©é…ç½®ï¼š
- **å¼€å‘ç¯å¢ƒ** (`NODE_ENV=development`): ä½¿ç”¨æœ¬åœ°Supabase
- **ç”Ÿäº§ç¯å¢ƒ** (`NODE_ENV=production`): ä½¿ç”¨äº‘ç«¯Supabase

### é…ç½®æ–‡ä»¶
- `.env.local` - å¼€å‘ç¯å¢ƒå˜é‡ï¼ˆå·²é…ç½®æœ¬åœ°Supabaseï¼‰
- `.env.production` - ç”Ÿäº§ç¯å¢ƒå˜é‡æ¨¡æ¿
- `supabase/config.toml` - SupabaseæœåŠ¡é…ç½®

## å¸¸ç”¨å‘½ä»¤

### Supabaseç®¡ç†
```bash
# å¯åŠ¨æœåŠ¡
npm run supabase:start

# åœæ­¢æœåŠ¡
npm run supabase:stop

# æ£€æŸ¥çŠ¶æ€
npm run supabase:status

# é‡ç½®æ•°æ®åº“ï¼ˆåº”ç”¨æ‰€æœ‰è¿ç§»ï¼‰
npm run supabase:reset
```

### å¼€å‘
```bash
# ä¸€é”®å¯åŠ¨æœ¬åœ°å¼€å‘
npm run dev:local

# ä»…å¯åŠ¨Next.jså¼€å‘æœåŠ¡å™¨
npm run dev

# æµ‹è¯•æœ¬åœ°è¿æ¥
npx tsx scripts/test-local-connection.ts
```

### ç±»å‹ç”Ÿæˆ
```bash
# ç”Ÿæˆæœ¬åœ°ç±»å‹å®šä¹‰
npm run db:local:types

# ç”Ÿæˆäº‘ç«¯ç±»å‹å®šä¹‰
npm run db:types
```

## æ•°æ®åº“ç®¡ç†

### è¿ç§»æ–‡ä»¶
æ‰€æœ‰æ•°æ®åº“å˜æ›´éƒ½åº”é€šè¿‡è¿ç§»æ–‡ä»¶è¿›è¡Œï¼š
```
supabase/migrations/
â”œâ”€â”€ 20260122154226_initial_schema.sql
â”œâ”€â”€ 20260131100000_add_project_members.sql
â”œâ”€â”€ 20260201120000_add_profiles_table.sql
â””â”€â”€ ...
```

### åº”ç”¨è¿ç§»
```bash
# é‡ç½®å¹¶åº”ç”¨æ‰€æœ‰è¿ç§»
npm run supabase:reset

# åº”ç”¨ç‰¹å®šè¿ç§»
npx supabase migration up --local
```

### ç§å­æ•°æ®
`supabase/seed.sql` åŒ…å«ï¼š
- å®æ—¶è®¢é˜…å¯ç”¨
- æµ‹è¯•ç”¨æˆ·æ•°æ®
- å…¶ä»–åˆå§‹åŒ–æ•°æ®

## å®æ—¶è®¢é˜…

æœ¬åœ°Supabaseæ”¯æŒå®æ—¶è®¢é˜…åŠŸèƒ½ã€‚å·²ä¸ºä»¥ä¸‹è¡¨å¯ç”¨å®æ—¶å¤åˆ¶ï¼š
- `projects`
- `tasks`
- `todos`
- `notes`
- `comments`
- `project_members`

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç«¯å£å†²çª
```
é”™è¯¯ï¼šç«¯å£54321å·²è¢«å ç”¨
```
**è§£å†³æ–¹æ¡ˆ**ï¼šä¿®æ”¹ `supabase/config.toml` ä¸­çš„ç«¯å£é…ç½®

#### 2. Dockeræ— æ³•å¯åŠ¨
```
é”™è¯¯ï¼šDocker Desktopæœªè¿è¡Œ
```
**è§£å†³æ–¹æ¡ˆ**ï¼š
- å¯åŠ¨Docker Desktopåº”ç”¨
- ç­‰å¾…Dockerå®Œå…¨å¯åŠ¨
- è¿è¡Œ `docker ps` éªŒè¯

#### 3. æ•°æ®åº“è¿æ¥å¤±è´¥
```
é”™è¯¯ï¼šæ— æ³•è¿æ¥åˆ°æ•°æ®åº“
```
**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
npm run supabase:status

# é‡å¯æœåŠ¡
npm run supabase:stop
npm run supabase:start

# é‡ç½®æ•°æ®åº“
npm run supabase:reset
```

#### 4. Authé‡å®šå‘é—®é¢˜
```
é”™è¯¯ï¼šé‡å®šå‘URLä¸åŒ¹é…
```
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. è®¿é—® http://localhost:54323
2. è¿›å…¥ Authentication > URL Configuration
3. æ·»åŠ é‡å®šå‘URL: `http://localhost:3000/auth/callback`

### è°ƒè¯•å·¥å…·
```bash
# æŸ¥çœ‹Supabaseæ—¥å¿—
npx supabase logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
npx supabase logs --service auth
npx supabase logs --service db
npx supabase logs --service realtime
```

## å¼€å‘å·¥ä½œæµç¨‹

### æ–°åŠŸèƒ½å¼€å‘
1. åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶
2. å¯åŠ¨æœ¬åœ°ç¯å¢ƒï¼š`npm run dev:local`
3. å¼€å‘åŠŸèƒ½å¹¶æµ‹è¯•
4. æäº¤è¿ç§»æ–‡ä»¶åˆ°ç‰ˆæœ¬æ§åˆ¶

### æ•°æ®åº“å˜æ›´
1. åˆ›å»ºæ–°çš„è¿ç§»æ–‡ä»¶
2. åœ¨æœ¬åœ°æµ‹è¯•å˜æ›´
3. æäº¤è¿ç§»æ–‡ä»¶
4. åœ¨ç”Ÿäº§ç¯å¢ƒåº”ç”¨è¿ç§»

### å›¢é˜Ÿåä½œ
1. æ–°å¼€å‘è€…å…‹éš†ä»“åº“
2. å®‰è£…Dockerå’ŒSupabase CLI
3. è¿è¡Œ `npm run dev:local`
4. å¼€å§‹å¼€å‘

## ç”Ÿäº§éƒ¨ç½²

### ç¯å¢ƒåˆ‡æ¢
åº”ç”¨è‡ªåŠ¨æ ¹æ®ç¯å¢ƒåˆ‡æ¢ï¼š
- å¼€å‘ç¯å¢ƒ â†’ æœ¬åœ°Supabase
- ç”Ÿäº§ç¯å¢ƒ â†’ äº‘ç«¯Supabase

### éƒ¨ç½²æ­¥éª¤
1. é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡ (`.env.production`)
2. æ„å»ºåº”ç”¨ï¼š`npm run build`
3. éƒ¨ç½²åˆ°æœåŠ¡å™¨
4. åº”ç”¨æ•°æ®åº“è¿ç§»åˆ°ç”Ÿäº§ç¯å¢ƒ

## æ€§èƒ½ä¼˜åŒ–

### æœ¬åœ°å¼€å‘ä¼˜åŠ¿
- **é›¶ç½‘ç»œå»¶è¿Ÿ** - æ‰€æœ‰è¯·æ±‚éƒ½åœ¨æœ¬åœ°
- **å¿«é€Ÿæ•°æ®åº“æ“ä½œ** - ç›´æ¥è®¿é—®PostgreSQL
- **å³æ—¶åé¦ˆ** - ä»£ç æ›´æ”¹ç«‹å³ç”Ÿæ•ˆ

### èµ„æºä½¿ç”¨
- Dockerå®¹å™¨ä¼šå ç”¨ç³»ç»Ÿèµ„æº
- å»ºè®®å¼€å‘æ—¶å…³é—­ä¸éœ€è¦çš„æœåŠ¡
- ä½¿ç”¨ `npm run supabase:stop` é‡Šæ”¾èµ„æº

## å®‰å…¨æ³¨æ„äº‹é¡¹

### æœ¬åœ°å¼€å‘
- æœ¬åœ°Supabaseä½¿ç”¨é»˜è®¤å¯†é’¥ï¼ˆå…¬å¼€å®‰å…¨ï¼‰
- å¼€å‘æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¸ä¼šæ³„éœ²
- æ— éœ€é…ç½®SSLè¯ä¹¦

### ç”Ÿäº§ç¯å¢ƒ
- ä½¿ç”¨å¼ºå¯†ç ä¿æŠ¤æœåŠ¡è§’è‰²å¯†é’¥
- å¯ç”¨Row Level Security (RLS)
- å®šæœŸå¤‡ä»½æ•°æ®åº“

## æ‰©å±•åŠŸèƒ½

### è‡ªå®šä¹‰é…ç½®
ä¿®æ”¹ `supabase/config.toml`ï¼š
```toml
[db]
port = 54322
# è°ƒæ•´å†…å­˜é™åˆ¶
memory = "2GB"

[auth]
port = 54323
# é…ç½®é‚®ä»¶æœåŠ¡
smtp_host = "smtp.gmail.com"
smtp_port = 587
```

### æ·»åŠ æ–°æœåŠ¡
```bash
# æŸ¥çœ‹å¯ç”¨æœåŠ¡
npx supabase services list

# å¯åŠ¨ç‰¹å®šæœåŠ¡
npx supabase services start [service-name]
```

## æ”¯æŒä¸åé¦ˆ

### æ–‡æ¡£èµ„æº
- [Supabase CLIæ–‡æ¡£](https://supabase.com/docs/guides/cli)
- [æœ¬åœ°å¼€å‘æŒ‡å—](https://supabase.com/docs/guides/local-development)
- [Dockeræ–‡æ¡£](https://docs.docker.com/)

### é—®é¢˜æŠ¥å‘Š
é‡åˆ°é—®é¢˜æ—¶ï¼š
1. æ£€æŸ¥æ—¥å¿—ï¼š`npx supabase logs`
2. éªŒè¯ç¯å¢ƒï¼š`npm run supabase:status`
3. é‡ç½®ç¯å¢ƒï¼š`npm run supabase:reset`
4. å¦‚æœé—®é¢˜æŒç»­ï¼Œæäº¤Issue

---

**æç¤º**ï¼šé¦–æ¬¡è®¾ç½®å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ä¸‹è½½Dockeré•œåƒã€‚åç»­å¯åŠ¨ä¼šå¾ˆå¿«ã€‚

**äº«å—æœ¬åœ°å¼€å‘çš„ä¾¿åˆ©å§ï¼** ğŸš€